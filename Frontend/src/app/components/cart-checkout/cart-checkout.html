<div class="cart-checkout-container">
  <div class="container">
    <div class="row">
      <!-- Cart Items Section -->
      <div class="col-lg-8">
        <div class="cart-section">
          <h2>Shopping Cart</h2>

          <div class="cart-items" *ngIf="cartItems.length > 0">
            <div class="cart-item" *ngFor="let item of cartItems">
              <div class="item-image">
                <img [src]="item.image" [alt]="item.name">
              </div>
              <div class="item-details">
                <h4>{{ item.name }}</h4>
                <p class="creator">by {{ item.creator }}</p>
                <p class="price">{{ item.price | currency:item.currency }}</p>
              </div>
              <div class="item-actions">
                <button class="btn btn-danger" (click)="removeFromCart(item.productId)">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>

            <!-- Continue Shopping Button -->
            <div class="continue-shopping">
              <a routerLink="/discover" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left"></i>
                Continue Shopping
              </a>
            </div>
          </div>

          <div class="empty-cart" *ngIf="cartItems.length === 0">
            <i class="fas fa-shopping-cart"></i>
            <h3>Your cart is empty</h3>
            <p>Add some products to get started!</p>
            <a routerLink="/discover" class="btn btn-primary">Browse Products</a>
          </div>
        </div>
      </div>

      <!-- Checkout Section -->
      <div class="col-lg-4" *ngIf="cartItems.length > 0">
        <div class="checkout-section">
          <h3>Checkout</h3>

          <!-- Order Summary -->
          <div class="order-summary">
            <h4>Order Summary</h4>
            <div class="summary-item" *ngFor="let item of cartItems">
              <span>{{ item.name }}</span>
              <span>{{ item.price | currency:item.currency }}</span>
            </div>
            <div class="summary-total">
              <strong>Total: {{ totalAmount | currency:'USD' }}</strong>
            </div>
          </div>

          <!-- Payment Method -->
          <div class="payment-method">
            <h4>Payment Method</h4>
            <div class="payment-options">
              <div class="payment-option" *ngFor="let method of paymentMethods">
                <input type="radio"
                       [id]="method.id"
                       name="paymentMethod"
                       [value]="method.id"
                       [(ngModel)]="selectedPaymentMethod">
                <label [for]="method.id">
                  <i [class]="method.icon"></i>
                  {{ method.name }}
                </label>
              </div>
            </div>
          </div>

          <!-- Checkout Form -->
          <form [formGroup]="checkoutForm" (ngSubmit)="processCheckout()">
            <div class="form-group">
              <label>Email</label>
              <input type="email" formControlName="email" class="form-control">
            </div>

            <div class="form-row">
              <div class="form-group col-md-6">
                <label>First Name</label>
                <input type="text" formControlName="firstName" class="form-control">
              </div>
              <div class="form-group col-md-6">
                <label>Last Name</label>
                <input type="text" formControlName="lastName" class="form-control">
              </div>
            </div>

            <div class="form-group">
              <label>Card Number</label>
              <input type="text" formControlName="cardNumber" class="form-control">
            </div>

            <div class="form-row">
              <div class="form-group col-md-6">
                <label>Expiry Date</label>
                <input type="text" formControlName="expiryDate" placeholder="MM/YY" class="form-control">
              </div>
              <div class="form-group col-md-6">
                <label>CVV</label>
                <input type="text" formControlName="cvv" class="form-control">
              </div>
            </div>

            <div class="form-group">
              <label>Billing Address</label>
              <textarea formControlName="billingAddress" class="form-control" rows="3"></textarea>
            </div>

            <div class="error-message" *ngIf="errorMessage">
              {{ errorMessage }}
            </div>

            <button type="submit"
                    class="btn btn-primary btn-block"
                    [disabled]="checkoutForm.invalid || isLoading">
              <span *ngIf="!isLoading">Complete Purchase</span>
              <span *ngIf="isLoading">Processing...</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Alert Component -->
  <app-alert *ngIf="errorMessage || successMessage"
    [type]="errorMessage ? 'error' : 'success'"
    [message]="errorMessage || successMessage"
    (close)="errorMessage = null; successMessage = null">
  </app-alert>
</div>
