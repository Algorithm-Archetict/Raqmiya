<div class="my-products-container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1>My Products</h1>
      <p class="text-muted mb-0">Manage your digital products and track their performance</p>
    </div>
    <a routerLink="/products/create" class="btn btn-primary">
      <i class="fas fa-plus me-2"></i>Create New Product
    </a>
  </div>

  <app-loading-spinner *ngIf="isLoading"></app-loading-spinner>
  <app-alert *ngIf="errorMessage" [message]="errorMessage" type="danger"></app-alert>

  <!-- Products Summary -->
  <div class="row mb-4" *ngIf="!isLoading && myProducts.length > 0">
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-primary">{{ totalItems }}</h5>
          <p class="card-text">Total Products</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-success">{{ getPublishedCount() }}</h5>
          <p class="card-text">Published</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-warning">{{ getDraftCount() }}</h5>
          <p class="card-text">Drafts</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-info">{{ getTotalSales() }}</h5>
          <p class="card-text">Total Sales</p>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && myProducts.length > 0" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    <div class="col" *ngFor="let product of myProducts; trackBy: trackByProduct">
      <div class="card h-100 product-card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <span class="badge" [class]="getProductStatusClass(product.status)">
              {{ product.status | titlecase }}
            </span>
            <small [class]="getProductVisibilityClass(product.isPublic)">
              <i class="fas fa-eye me-1"></i>{{ getProductVisibilityText(product.isPublic) }}
            </small>
          </div>
          
          <h5 class="card-title">{{ product.name }}</h5>
          <p class="card-text text-muted">{{ product.description || 'No description available' }}</p>
          
          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="h6 text-primary mb-0">
              {{ product.price | currency:product.currency:'symbol':'1.2-2' }}
            </span>
            <small class="text-muted">
              <i class="fas fa-star text-warning me-1"></i>
              {{ product.averageRating | number:'1.1-1' }}
            </small>
          </div>
          
          <div class="row text-center mb-3">
            <div class="col-6">
              <small class="text-muted d-block">Sales</small>
              <strong>{{ product.salesCount }}</strong>
            </div>
            <div class="col-6">
              <small class="text-muted d-block">Rating</small>
              <strong>{{ product.averageRating | number:'1.1-1' }}</strong>
            </div>
          </div>
          
          <div class="d-grid gap-2">
            <a [routerLink]="['/products/detail', product.id]" class="btn btn-outline-primary btn-sm">
              <i class="fas fa-eye me-1"></i>View Details
            </a>
            <a [routerLink]="['/products/edit', product.id]" class="btn btn-outline-secondary btn-sm">
              <i class="fas fa-edit me-1"></i>Edit
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && myProducts.length === 0 && !errorMessage" class="text-center py-5">
    <div class="empty-state">
      <i class="fas fa-box-open fa-4x text-muted mb-3"></i>
      <h3>No products yet</h3>
      <p class="text-muted">You haven't created any products yet. Start by creating your first digital product!</p>
      <a routerLink="/products/create" class="btn btn-primary">
        <i class="fas fa-plus me-2"></i>Create Your First Product
      </a>
    </div>
  </div>

  <!-- Enhanced Pagination -->
  <nav *ngIf="totalPages > 1 && !isLoading" aria-label="My products list pagination" class="mt-4">
    <div class="d-flex justify-content-between align-items-center">
      <div class="pagination-info">
        <small class="text-muted">
          Showing {{ (currentPage - 1) * itemsPerPage + 1 }} - {{ Math.min(currentPage * itemsPerPage, totalItems) }} of {{ totalItems }} products
        </small>
      </div>
      
      <ul class="pagination mb-0">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="onPageChange(currentPage - 1)" [disabled]="currentPage === 1">
            <i class="fas fa-chevron-left"></i>
          </button>
        </li>
        
        <li class="page-item" *ngFor="let pageNum of getVisiblePages()" 
            [class.active]="pageNum === currentPage"
            [class.disabled]="pageNum === '...'">
          <button class="page-link" 
                  (click)="onPageChange(pageNum)" 
                  [disabled]="pageNum === '...'">
            {{ pageNum }}
          </button>
        </li>
        
        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <button class="page-link" (click)="onPageChange(currentPage + 1)" [disabled]="currentPage === totalPages">
            <i class="fas fa-chevron-right"></i>
          </button>
        </li>
      </ul>
    </div>
  </nav>
</div>
